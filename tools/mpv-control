#!/bin/bash
#
# This is a mapping of 
#
#   /usr/include/X11/keysymdef.h and
#   http://man.openbsd.org/OpenBSD-current/man1/tmux.1#KEY_BINDINGS
#

host=192.168.0.50

amixer_prefix='amixer -D pulse sset Master'
amixer_step=4%
pactl_prefix='pactl set-sink-volume $(pactl list sinks | grep -C 4 MPOW | grep -E "^S" | cut -d "#" -f 2)'
pactl_step=2000

if [[ $1 == 'd' ]]; then
  tmp=$(mktemp)
  ssh $host "~/bin/mpv-details" > $tmp
  xmessage -timeout 14 -file $tmp
  rm $tmp
  exit
elif [[ $1 == '9' ]]; then
  ssh $host "$pactl_prefix -$pactl_step;$amixer_prefix $amixer_step-"
  exit
elif [[ $1 == '0' ]]; then
  ssh $host "$pactl_prefix +$pactl_step;$amixer_prefix $amixer_step+"
  exit
fi

declare -A mapping=( [p]='pu ENTER' [return]='ENTER' [space]='" "' [comma]='<' [period]='>' [s]='s ENTER' [r]='r ENTER' )
[[ ${mapping[$1]+_} ]] && control=${mapping[$1]} || control=$1

# debugging
# echo $(date) "$1->($control)" >> /tmp/keycode
#

ssh $host "tmux send-keys -t mpv-once $control"
